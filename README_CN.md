# ğŸ•·ï¸ Spider Agent Universal

> è¿™æ˜¯ä» [Spider2 é¡¹ç›®](https://github.com/xlang-ai/Spider2) ä¸­æŠ½è±¡å‡ºæ¥çš„å¯å¯¹è¯çš„ Spider Agentï¼Œæ”¯æŒå¤šæ•°æ®åº“æŸ¥è¯¢å’Œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ™ºèƒ½ä½“ç³»ç»Ÿã€‚

[ğŸ‡¨ğŸ‡³ ä¸­æ–‡æ–‡æ¡£](./README_CN.md) | [ğŸ‡ºğŸ‡¸ English](./README.md)

## ğŸ“– é¡¹ç›®ç®€ä»‹

Spider Agent Universal æ˜¯ä¸€ä¸ªåŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„çš„æ™ºèƒ½ä½“ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºå¤„ç†å¤æ‚çš„æ•°æ®åº“æŸ¥è¯¢å’Œç³»ç»Ÿæ“ä½œä»»åŠ¡ã€‚å®ƒç»§æ‰¿äº† Spider2 é¡¹ç›®çš„æ ¸å¿ƒèƒ½åŠ›ï¼Œå¹¶æä¾›äº†æ›´çµæ´»çš„å¯¹è¯å¼äº¤äº’ä½“éªŒã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ—„ï¸ **å¤šæ•°æ®åº“æ”¯æŒ**: MySQLã€PostgreSQLã€SQLiteã€Snowflake
- ğŸ’» **ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ**: å®‰å…¨çš„ Bash å‘½ä»¤æ‰§è¡Œç¯å¢ƒ
- ğŸ”„ **å®¢æˆ·ç«¯-æœåŠ¡å™¨åˆ†ç¦»**: é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼æ¶æ„
- ğŸ›¡ï¸ **å®‰å…¨ä¿æŠ¤**: è¶…æ—¶æ§åˆ¶ã€è¾“å‡ºé™åˆ¶ã€é”™è¯¯å¤„ç†
- ğŸš€ **é«˜æ€§èƒ½**: è¿æ¥æ± ç®¡ç†ã€å¼‚æ­¥æ‰§è¡Œã€æ™ºèƒ½æˆªæ–­

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ API å¯†é’¥å’Œé…ç½®ä¿¡æ¯
```

### 2. æ•°æ®åº“å‡­æ®é…ç½®

åœ¨ `credentials/` ç›®å½•ä¸‹åˆ›å»ºç›¸åº”çš„æ•°æ®åº“å‡­æ®æ–‡ä»¶ï¼š

```bash
credentials/
â”œâ”€â”€ mysql_credential.json
â”œâ”€â”€ postgresql_credential.json
â”œâ”€â”€ sqlite_credential.json
â””â”€â”€ snowflake_credential.json
```

### 3. å¯åŠ¨ç³»ç»Ÿ

```bash
# å¯åŠ¨å·¥å…·æœåŠ¡å™¨
./run_server.sh

# å¯åŠ¨å®¢æˆ·ç«¯ Agentï¼ˆæ–°ç»ˆç«¯çª—å£ï¼‰
./run_chat.sh
```

> ğŸ’¡ æç¤ºï¼šå¯ä»¥åœ¨ `run_chat.sh` ä¸­ä¿®æ”¹æ¨¡å‹åç§°

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP API    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯ Agent   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   å·¥å…·æœåŠ¡å™¨     â”‚
â”‚   (llm_agent)   â”‚                â”‚   (serve.py)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                   â”‚
â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¶ˆæ¯å¤„ç†å™¨       â”‚                â”‚ å·¥å…·æ³¨å†Œè¡¨       â”‚
â”‚(message_processor)â”‚               â”‚(tool_registry)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å·¥å…·é›†åˆ       â”‚
â”‚ â€¢ database_tool â”‚
â”‚ â€¢ bash_tool     â”‚
â”‚ â€¢ snowflake_toolâ”‚
â”‚ â€¢ terminator_toolâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

## ğŸ› ï¸ æ ¸å¿ƒå·¥å…·

### 1. ğŸ“Š æ•°æ®åº“æŸ¥è¯¢å·¥å…· (execute_database_sql)

**åŠŸèƒ½**: æ‰§è¡Œ SQL æŸ¥è¯¢ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ç±»å‹

**æ”¯æŒçš„æ•°æ®åº“**:
- MySQL
- PostgreSQL  
- SQLite
- Snowflake

**ç‰¹æ€§**:
- è¿æ¥æ± ç®¡ç†å’Œå¤ç”¨
- æ™ºèƒ½ç»“æœæˆªæ–­ï¼ˆ2000å­—ç¬¦é™åˆ¶ï¼‰
- CSV æ ¼å¼è¾“å‡º
- 60ç§’è¶…æ—¶ä¿æŠ¤

### 2. ğŸ’» ç³»ç»Ÿå‘½ä»¤å·¥å…· (execute_bash)

**åŠŸèƒ½**: å®‰å…¨æ‰§è¡Œç³»ç»Ÿ Bash å‘½ä»¤

**ç‰¹æ€§**:
- å·¥ä½œç›®å½•æŒ‡å®š
- è¾“å‡ºæ•è·ï¼ˆstdout/stderrï¼‰
- 30ç§’è¶…æ—¶ä¿æŠ¤
- æ™ºèƒ½è¾“å‡ºæˆªæ–­

### 3. â„ï¸ Snowflake ä¸“ç”¨å·¥å…· (execute_snowflake_sql)

**åŠŸèƒ½**: ä¸“é—¨ä¼˜åŒ–çš„ Snowflake æ•°æ®åº“æŸ¥è¯¢å·¥å…·

**ç‰¹æ€§**:
- ä¸“ç”¨è¿æ¥é…ç½®
- ä¼˜åŒ–çš„è¶…æ—¶è®¾ç½®
- é«˜æ•ˆçš„ç»“æœå¤„ç†

### 4. ğŸ ä»»åŠ¡ç»ˆæ­¢å·¥å…· (terminate)

**åŠŸèƒ½**: ä¼˜é›…åœ°ç»“æŸä»»åŠ¡å¹¶è¿”å›æœ€ç»ˆç­”æ¡ˆ

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½® (.env)

```bash
# API é…ç½®
API_HOST=localhost
API_PORT=8000

# æ¨¡å‹é…ç½®
MODEL_NAME=your-model-name
API_KEY=your-api-key

# æ•°æ®åº“è·¯å¾„
DATABASES_PATH=./databases
```

### æ•°æ®åº“å‡­æ®ç¤ºä¾‹

**MySQL å‡­æ®** (`credentials/mysql_credential.json`):
```json
{
    "host": "localhost",
    "port": 3306,
    "user": "username",
    "password": "password",
    "database": "database_name"
}
```

**Snowflake å‡­æ®** (`credentials/snowflake_credential.json`):
```json
{
    "account": "your-account",
    "user": "username",
    "password": "password",
    "warehouse": "warehouse_name",
    "database": "database_name",
    "schema": "schema_name"
}
```

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### è¶…æ—¶ä¿æŠ¤
- æ•°æ®åº“æŸ¥è¯¢ï¼š60ç§’è¶…æ—¶
- Bash å‘½ä»¤ï¼š30ç§’è¶…æ—¶
- HTTP è¯·æ±‚ï¼š30ç§’è¶…æ—¶

### è¾“å‡ºé™åˆ¶
- CSV ç»“æœï¼š2000å­—ç¬¦æ™ºèƒ½æˆªæ–­
- Bash è¾“å‡ºï¼š2000å­—ç¬¦æ™ºèƒ½æˆªæ–­
- è¾¹ç•Œæˆªæ–­ï¼Œé¿å…æ•°æ®ç ´æŸ

### é”™è¯¯å¤„ç†
- å…¨é¢çš„å¼‚å¸¸æ•è·
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- ä¼˜é›…çš„é”™è¯¯æ¢å¤

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### è¿æ¥ç®¡ç†
- æ•°æ®åº“è¿æ¥æ± å¤ç”¨
- å…¨å±€è¿æ¥å™¨å•ä¾‹æ¨¡å¼
- è‡ªåŠ¨è¿æ¥æ¸…ç†

### å¼‚æ­¥å¤„ç†
- çº¿ç¨‹æ± æ‰§è¡Œï¼ˆæ¯å·¥å…·8ä¸ªworkerï¼‰
- å¼‚æ­¥å·¥å…·è°ƒç”¨
- éé˜»å¡ HTTP å“åº”

### æ™ºèƒ½æˆªæ–­
- å®Œæ•´è¡Œè¾¹ç•Œæˆªæ–­
- é¿å…æ•°æ®ç ´æŸ
- ä¿æŒè¾“å‡ºå¯è¯»æ€§

## ğŸ“ é¡¹ç›®ç»“æ„
spider-agent-universal/
â”œâ”€â”€ agent/                  # å®¢æˆ·ç«¯ Agent ä»£ç 
â”‚   â”œâ”€â”€ llm_agent.py       # ä¸»è¦ Agent é€»è¾‘
â”‚   â”œâ”€â”€ message_processor.py # æ¶ˆæ¯å¤„ç†å™¨
â”‚   â””â”€â”€ ...
â”œâ”€â”€ servers/               # æœåŠ¡å™¨ç«¯ä»£ç 
â”‚   â”œâ”€â”€ serve.py          # FastAPI æœåŠ¡å™¨
â”‚   â”œâ”€â”€ tools/            # å·¥å…·å®ç°
â”‚   â””â”€â”€ utils/            # å·¥å…·æ³¨å†Œè¡¨
â”œâ”€â”€ prompts/              # æç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ credentials/          # æ•°æ®åº“å‡­æ®ï¼ˆéœ€è‡ªè¡Œåˆ›å»ºï¼‰
â”œâ”€â”€ .env.example         # ç¯å¢ƒé…ç½®æ¨¡æ¿
â””â”€â”€ requirements.txt     # Python ä¾èµ–

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº Spider2 é¡¹ç›®å¼€å‘ï¼Œè¯·å‚è€ƒåŸé¡¹ç›®çš„è®¸å¯è¯æ¡æ¬¾ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [Spider2 åŸé¡¹ç›®](https://github.com/xlang-ai/Spider2)
- [Spider2 è®ºæ–‡](https://arxiv.org/abs/2411.07763)
- [ICLR 2025 Oral å‘è¡¨](https://github.com/xlang-ai/Spider2)

---

